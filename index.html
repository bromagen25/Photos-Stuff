<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bromagens Rugby Photos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Custom styles for black background and red text */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #000000; /* Black background */
            color: #FF0000; /* Red text */
        }
        .gallery-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            cursor: pointer;
        }
        .gallery-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(255, 0, 0, 0.5), 0 4px 6px -2px rgba(255, 0, 0, 0.25);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center py-8 px-4 sm:px-6 lg:px-8">

    <header class="w-full max-w-7xl flex justify-between items-center mb-12 p-4 bg-gray-900 rounded-xl shadow-lg">
        <div class="flex items-center space-x-4">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-red-600">Bromagens Rugby Photos</h1>
        </div>
        <nav class="flex space-x-4">
            <button id="shareButton" class="flex items-center space-x-2 px-4 py-2 bg-red-700 text-white rounded-lg hover:bg-red-800 transition duration-300 transform hover:scale-105">
                <i class="fas fa-share-alt"></i>
                <span class="hidden sm:inline">Share</span>
            </button>
        </nav>
    </header>

    <main class="w-full max-w-7xl">
        <div id="gallery-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 p-6 gallery-section-bg rounded-xl shadow-2xl">
            </div>
        <div id="loadingMessage" class="mt-8 text-center text-lg text-gray-400">Loading galleries...</div>
        <div id="errorMessage" class="mt-8 text-center text-lg text-red-500 hidden"></div>
    </main>

    <div id="shareModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="bg-gray-800 p-8 rounded-lg shadow-xl max-w-lg w-full relative">
            <button id="closeShareModal" class="absolute top-2 right-2 text-gray-400 hover:text-white text-2xl" aria-label="Close share modal">&times;</button>
            <h2 class="text-2xl font-bold mb-4 text-white">Share This Page</h2>
            <div class="flex items-center space-x-2">
                <input type="text" id="shareLinkInput" readonly class="flex-grow p-2 rounded-lg bg-gray-700 text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-600">
                <button id="copyLinkButton" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition">
                    <i class="fas fa-copy"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const galleryGrid = document.getElementById('gallery-grid');
            const loadingMessage = document.getElementById('loadingMessage');
            const errorMessage = document.getElementById('errorMessage');
            const shareButton = document.getElementById('shareButton');
            const shareModal = document.getElementById('shareModal');
            const closeShareModal = document.getElementById('closeShareModal');
            const shareLinkInput = document.getElementById('shareLinkInput');
            const copyLinkButton = document.getElementById('copyLinkButton');

            async function loadGalleries() {
                try {
                    const response = await fetch('galleries.json');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const galleries = await response.json();
                    loadingMessage.classList.add('hidden');
                    if (galleries.length === 0) {
                        errorMessage.classList.remove('hidden');
                        errorMessage.textContent = 'No galleries found.';
                        return;
                    }
                    galleries.forEach(gallery => {
                        const galleryCard = document.createElement('a');
                        // Use the new dynamic link
                        galleryCard.href = `gallery.html?id=${gallery.id}`; 
                        galleryCard.className = 'gallery-card flex flex-col items-center p-6 bg-gray-800 rounded-lg shadow-md hover:shadow-xl transition-all duration-300';
                        galleryCard.innerHTML = `
                            <img src="${gallery.icon}" alt="${gallery.name}" class="w-32 h-32 rounded-full mb-4 object-cover border-4 border-red-600">
                            <h2 class="text-xl font-bold text-red-500 text-center mb-2">${gallery.name}</h2>
                            <p class="text-gray-400 text-sm text-center">${gallery.description}</p>
                        `;
                        galleryGrid.appendChild(galleryCard);
                    });
                } catch (error) {
                    loadingMessage.classList.add('hidden');
                    errorMessage.classList.remove('hidden');
                    errorMessage.textContent = `Failed to load galleries: ${error.message}. Please ensure 'galleries.json' exists and is correctly formatted.`;
                }
            }

            // Share button functionality
            shareButton.addEventListener('click', () => {
                shareLinkInput.value = window.location.href; 
                shareModal.classList.remove('hidden');
            });

            closeShareModal.addEventListener('click', () => {
                shareModal.classList.add('hidden');
            });

            copyLinkButton.addEventListener('click', () => {
                shareLinkInput.select();
                document.execCommand('copy'); 
                copyLinkButton.textContent = 'Copied!';
                setTimeout(() => {
                    copyLinkButton.innerHTML = '<i class="fas fa-copy"></i> Copy';
                }, 2000);
            });

            // Close modal if clicked outside content
            shareModal.addEventListener('click', (e) => {
                if (e.target === shareModal) {
                    shareModal.classList.add('hidden');
                }
            });

            // Initial load of galleries
            loadGalleries();
        });
    </script>
</body>
</html>